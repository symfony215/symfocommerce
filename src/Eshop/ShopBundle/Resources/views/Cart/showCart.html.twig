{% extends '@Shop/layout.html.twig' %}

{% block title %}
    Cart
{% endblock title %}

{% block page_content -%}
    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            {% if products|length %}
                {#<table class="table table-striped table-bordered">#}
                    {#<tbody>#}
                    {#<tr class="info">#}
                        {#<th>â„–</th>#}
                        {#<th>Name</th>#}
                        {#<th>Quantity</th>#}
                        {#<th>Price</th>#}
                        {#<th>Total</th>#}
                    {#</tr>#}
                    {#{% for product in products %}#}
                        {#<tr>#}
                            {#<td align="center">{{ loop.index }}</td>#}
                            {#<td>{{ product.product.name }}</td>#}
                            {#<td align="center">{{ product.quantity }}</td>#}
                            {#<td align="center">{{ product.price }}</td>#}
                            {#<td align="center">{{ product.sum }}</td>#}
                        {#</tr>#}
                    {#{% endfor %}#}
                    {#<tr class="warning">#}
                        {#<td colspan="3"><b>Total sum of the order</b></td>#}
                        {#<td colspan="2"><b>{{ totalsum }}</b></td>#}
                    {#</tr>#}
                    {#</tbody>#}
                {#</table>#}

                <table class="table">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Product</th>
                        <th>Quantity</th>
                        <th></th>
                        <th>Price</th>
                        <th style="text-align: right;">Sum</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for product in products %}
                        <tr class="product-position">
                            <td class="col-md-1">{{ loop.index }}</td>
                            <td>
                                <a href="#" class="thumbnail pull-left" style="margin-right: 15px;">
                                {% if product.product.images|length %}
                                    <img src="{{ asset( ('uploads/gallery/' ~ product.product.images.first().path) | imagine_filter('some_thumb')) }}"
                                         alt="{{ product.product.name }}">
                                {% else %}
                                    <img src="{{ asset( ('uploads/gallery/no_image_available.png') | imagine_filter('some_thumb')) }}"
                                         alt="{{ product.product.name }}">
                                {% endif %}
                                </a>
                                <div>
                                    <a href="{{ path('show_product', {'id' : product.product.id}) }}"><strong>{{ product.product.name }}</strong></a>
                                    <ul class="list-unstyled">
                                    </ul>
                                </div>
                            </td>
                            <td class="col-md-2">
                                <div class="form-group">
                                    <div>
                                        <input type="number" name="quantity" required="required" min="1" data-id="{{ product.product.id }}"
                                                class="form-control quantity" value="{{ product.quantity }}">
                                    </div>
                                </div>
                            </td>
                            <td class="col-md-1">
                                <a href="#" class="btn btn-danger glyphicon glyphicon-trash product-remove"><i class="icon-trash icon-white"></i></a>
                            </td>
                            <td class="col-md-1 price">
                                <span>{{ product.price }}</span>
                            </td>
                            <td class="col-md-1 sum" style="text-align: right">
                                {{ product.sum }}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                    <tfoot>
                    <tr>
                        <td colspan="6" style="text-align: right;">
                            <strong>Total sum of the order:</strong>
                            <span class="totalsum">{{ totalsum }}</span>
                        </td>
                    </tr>
                    </tfoot>
                </table>
            {% else %}
                Cart is empty
            {% endif %}
        </div>
    </div>
{% endblock page_content %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/shop/js/js.cookie.js') }}"></script>
    <script src="{{ asset('bundles/shop/js/cart.js') }}" type="text/javascript"></script>
{% endblock javascripts %}